<!DOCTYPE html>
<html>

<head>
    <title>Helpdesk</title>
    <link rel="stylesheet" href="create.css">
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
  <link rel="icon" href="/images/heldeskicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="/images/heldeskicon.png" type="image/x-icon">
    <script type="text/javascript">
        function preventBack() {
            window.history.forward();
        }

        setTimeout("preventBack()", 0);

        window.onunload = function() {
            null
        };
    </script>
</head>

<body>

    <div class="container" id="homepage">
        <img src="/images/helpdesk-removebg-preview.png" alt="" id="logo">

        <h1 class="Helpdesk animate__animated animate__pulse">Create a new account</h1>
        <form action="/register" method="POST" onsubmit="return validateForm()">
            <label for="who">Who are you:</label>
            <select name="who" id="whos" onchange="showDepartment()">
            <option value="Select">Select</option>
            <option value="admin">Admin</option>
            <option value="user">User</option>
        </select>
            <div id="departments" style="display: none">
                <label for="department">Departments:</label>
                <select name="department" id="department">
                <option value="Select">Select</option>
                <option value="General Inquiries">General Inquiries</option>
                <option value="Customer Support">Customer Support</option>
                <option value="Human Resources">Human Resources</option>
                <option value="Finance and Accounting">Finance and Accounting</option>
                <option value="Marketing and Communications">Marketing and Communications</option>
                <option value="Sales">Sales</option>
                <option value="Legal and Compliance">Legal and Compliance</option>
                <option value="Project Management">Project Management</option>
                <option value="Scheduling and Reservations">Scheduling and Reservations</option>
            </select>
            </div>

            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
            <label for="email">Email:</label>
            <input type="email" name="email" required>
            <label for="password">Password:</label>
            <input type="password" name="password" required>
            <button class="btn-grad" type="submit">Create Account</button>
            <button class="btn-grad"><a href="./" style="color: aliceblue;">Back to Login</a></button>
        </form>
        <script>
            function validateForm() {
                var department = document.getElementById("department").value;
                var username = document.getElementById("username").value;
                var who = document.getElementById("whos").value;

                function isAlphaNumeric(str) {
                    const regex = /^[a-zA-Z0-9]+$/;
                    return regex.test(str);
                }

                if (!isAlphaNumeric(username)) {
                    alert("Username should be alphanumeric");
                    return false;
                }

                // Check if the selected department is "Select"
                if ((who === "admin") && (department === "Select")) {
                    alert("Please select a department");
                    return false; // Prevent form submission
                }
            }

            function showDepartment() {
                var userRole = document.getElementById("whos").value;
                var departmentSelect = document.getElementById("departments");

                if (userRole === "admin") {
                    departmentSelect.style.display = "block";
                } else {
                    departmentSelect.style.display = "none";
                }
            }
        </script>
</body>

</html>